<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8"/>
    <title>OBF3</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<body>
<div id="app" class="container-fluid">
    <!--    sidebar-->
    <div class="row">
        <div class="col d-flex flex-column text-white bg-dark" style="height: 100vh;">
            <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
                <div class="row">
                    <div class="col-3">
                        <img src="https://cdn.discordapp.com/attachments/904455843813154837/909234894331334696/dunnoO-blue.png"
                             width="50" height="50">
                    </div>
                    <div class="col-9">
                        <h3 class="text-center">OBF-3</h3>
                    </div>
                </div>
            </a>
            <hr>
            <span class="fs-4 mb-2">Channels</span>
            <ul class="nav nav-pills flex-column mb-auto">
                <li v-for="channel in channels" class="nav-item">
                    <a :href="channel" class="nav-link active" aria-current="page" onclick="switchChannel(this)">
                        <svg class="bi me-2" width="16" height="16"></svg>
                        <span>{{channel}}
                        <span class="badge rounded-pill bg-light text-dark">{{userNum}}
                        </span>
                        </span>
                    </a>
                </li>
            </ul>
            <hr>
            <!-- Button trigger modal -->
            <button class="nav-link text-white text-center rounded-pill bg-secondary" data-bs-toggle="modal"
                    data-bs-target="#personalMessages">
                Personal Messages
            </button>

            <!-- Modal -->
            <div class="modal fade" id="personalMessages" tabindex="-1" role="dialog"
                 aria-labelledby="#personalMessagesLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body text-dark">
                            Room title input here
                            <hr>
                            attribute selection here
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close
                            </button>
                            <button type="button" class="btn btn-primary">Create</button>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <!-- Button trigger modal -->
            <button type="button" class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#makeRoom">
                Make Room
            </button>

            <!-- Modal -->
            <div class="modal fade" id="makeRoom" tabindex="-1" role="dialog"
                 aria-labelledby="#makeRoomLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title text-dark" id="makeRoomLabel">Make a new game room</h5>
                            <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body text-dark">
                            Room title input here
                            <hr>
                            attribute selection here
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close
                            </button>
                            <button type="button" class="btn btn-primary">Create</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Button trigger modal -->
            <button type="button" class="btn btn-primary mb-2" data-bs-toggle="modal" data-bs-target="#joinChannel">
                Join Channel
            </button>

            <!-- Modal -->
            <div class="modal fade" id="joinChannel" tabindex="-1" role="dialog"
                 aria-labelledby="#joinChannelLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title text-dark" id="joinChannelLabel">Join a channel</h5>
                            <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body text-dark">
                            channel to join here
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close
                            </button>
                            <button type="button" class="btn btn-primary">Join</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--        main content-->
        <div class="col-10">
            <div class="card text-white bg-dark" style="height: 100vh;">
                <h2 class="card-header text-center">
                    {{channel_name}}
                </h2>
                <div v-if="inProgress">
                    <span class="badge bg-success">In Progress...</span>
                </div>
                <hr>
                <!--                limits and ranges-->
                <div class="container card-body text-center">
                    <div class="row">
                        <div class="col-1 card bg-secondary">
                            AR range
                            min
                            <input type="range" class="form-range" min="0" max="10" step="1" id="arRangeMin">
                            max
                            <input type="range" class="form-range" min="0" max="10" step="1" id="arRangeMax">
                        </div>
                        <div class="col-1 card bg-secondary">
                            OD range
                        </div>
                        <div class="col-1 card bg-secondary">
                            CS range
                        </div>
                        <div class="col-1 card bg-secondary">
                            HP range
                        </div>
                        <div class="col-1 card bg-secondary">
                            BPM range
                        </div>
                        <div class="col-1 card bg-secondary">
                            Length range
                        </div>
                        <div class="col-1 card bg-secondary">
                            Difficulty range
                        </div>
                        <div class="col-1 card bg-secondary">
                            Game Mode
                        </div>
                        <div class="col-1 card bg-secondary">
                            Mods
                        </div>
                        <div class="col-1 card bg-secondary">
                            Scoring Type
                        </div>
                        <div class="col-1 card bg-secondary">
                            Team Type
                        </div>
                        <div class="col-1 card bg-secondary">
                            Map Status
                        </div>
                    </div>
                </div>
                <div class="container">
                    <div class="row">
                        <!--                    players-->
                        <div class="col-3">
                            <div class="card text-white bg-secondary">
                                <h3 class="text-center mt-2">Players<span
                                        class="card-header badge rounded-pill ms-4 bg-light text-dark">{{userNum}}</span>
                                </h3>
                                <hr>

                                <div style="overflow-y: scroll; height: 59vh">
                                    <table class="table table-sm text-white">
                                        <thead>
                                        <tr>
                                            <th scope="col">#</th>
                                            <th scope="col">Username</th>
                                            <th scope="col">Badges</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <template>
                                            <tr v-for="(slot, index) in slots">
                                                <th scope="row">{{parseInt(index) + 1}}</th>
                                                <td>{{slot.username}}</td>
                                                <div v-if="slot.host">
                                                    <td>Host</td>
                                                </div>
                                                <div v-else>
                                                    <td></td>
                                                </div>
                                            </tr>
                                        </template>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <!--                    chat-->
                        <div class="col-7">
                            <div class="card text-white bg-secondary text-center">
                                <h3 class="card-title">Chat</h3>
                                <hr>
                                <div class="container">
                                    <div class="card text-white bg-dark">
                                        <div style="overflow-y: scroll; height: 50vh;">
                                            <table id="chat" class="table text-white">
                                                <tbody>
                                                <tr>
                                                    <th scope="row">Mickey</th>
                                                    <td>this is a message that was sent</td>
                                                </tr>
                                                <tr>
                                                    <th scope="row">Mickey</th>
                                                    <td>this is a message that was sent</td>
                                                </tr>
                                                <tr>
                                                    <th scope="row">Mickey</th>
                                                    <td>this is a message that was sent</td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <!--                                    input section-->
                                    <div class="card mb-4">
                                        <div class="input-group mt-1 mb-1">
                                            <input type="text" class="form-control" placeholder="Say something..."
                                                   aria-label="Chatbox" aria-describedby="button-addon2">
                                            <button class="btn btn-dark" type="button" id="button-addon2">Send
                                            </button>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="col-2">
                            <!--                        beatmap-->
                            <div class="card bg-secondary mb-4">
                                <h3 class="card-header text-center">Beatmap</h3>
                                <h5 class="text-center mt-2">Getty vs. DJ DiA - DropZ-Line- (Realazy) [fanzhen's
                                    Extreme]</h5>
                                <hr>
                                <img src="https://assets.ppy.sh/beatmaps/727049/covers/card.jpg?1622132738"
                                     class="rounded"
                                     alt="..."
                                     width="190">
                                <hr>
                                <div class="mb-3">
                                    <span class="badge rounded-pill bg-info text-dark">4.06 Star</span>
                                    <span class="badge rounded-pill bg-info text-dark">2 min 22 sec</span>
                                    <span class="badge rounded-pill bg-info text-dark">taiko</span>
                                </div>
                            </div>
                            <div class="card bg-secondary">
                                <!--                            buttons-->
                                <div class="dropdown text-center">
                                    <h6>Logic Profile</h6>
                                    <button class="btn btn-secondary dropdown-toggle" type="button"
                                            id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                                        <span class="badge bg-secondary">{{logic_profile}}</span>
                                    </button>
                                    <ul class="dropdown-menu" aria-labelledby="logicProfiles">
                                        <li><a class="dropdown-item" href="#">AutoHostRotate</a></li>
                                        <li><a class="dropdown-item" href="#">KingOfTheHill</a></li>
                                        <li><a class="dropdown-item" href="#">Something else here</a></li>
                                    </ul>
                                </div>
                                <hr>
                                <table class="table">
                                    <tbody>
                                    <tr>
                                        <td>
                                            <button type="button" class="btn btn-success">Start Game</button>
                                        </td>
                                        <td>
                                            <button type="button" class="btn btn-danger">Abort Game</button>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                                <button type="button" class="btn rounded-pill btn-warning text-secondary mb-3">Advanced
                                    Options
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
<script>
    var sock = new WebSocket("ws://localhost:9876/");
    var data;
    var channel = "#english";
    var app;
    window.onload = function () {
        sock.onopen = function () {
        };

        sock.onerror = function (error) {
            console.log('WebSocket Error ' + error);
        };

        sock.onmessage = function (e) {
            console.log('Server: ' + e.data);
            data = JSON.parse(e.data);
            makeVue();
        };
    };

    function makeVue() {
        app = new Vue({
            el: "#app",
            data: {
                channel_name: channel,
                logic_profile: data["channels"][channel]["logic_profile"],
                slots: data["channels"][channel]["slots"],
                users: data["channels"][channel]["users"],
                userNum: data["channels"][channel]["users"].length,
                host: data["channels"][channel]["host"],
                channels: Object.keys(data["channels"]),
                inProgress: data["channels"][channel]["in_progreses"],

            }
        })
    }

    function switchChannel(data) {
        channel = data.getAttribute("href");
        makeVue();
    }
</script>

</body>
</html>
